"""
This script computes the average processed (stop words removed) sentence length based on the sentences collection.
"""

from db.MongoDB import MongoDB
import io

# Change this to the number of sentences already processed if you want to resume the script.
START_COUNT = 71400000

mongo = MongoDB()
sentences = mongo.sentences
LIMIT = 100000
output = io.open('sentences.txt', mode='a+', encoding='utf-8')

total_processed = START_COUNT
try:
    while True:
        ss = sentences.find({'movie_id': {'$in': ['tt0071562', 'tt0108052', 'tt0167261', 'tt0137523', 'tt0110912', 'tt1375666', 'tt0068646', 'tt0468569', 'tt0060196', 'tt0120737', 'tt0109830', 'tt0111161', 'tt0099685', 'tt7286456', 'tt0056058', 'tt0073486', 'tt0050083', 'tt0167260', 'tt0133093', 'tt0080684', 'tt6751668', 'tt0816692', 'tt0245429', 'tt0120689', 'tt0120815', 'tt0118799', 'tt0047478', 'tt0114369', 'tt3417422', 'tt0076759', 'tt0038650', 'tt0317248', 'tt0102926', 'tt2582802', 'tt6316138', 'tt1675434', 'tt4154796', 'tt0253474', 'tt0482571', 'tt0407887', 'tt4154756', 'tt0114814', 'tt0120586', 'tt0110357', 'tt0088763', 'tt0110413', 'tt0095327', 'tt0095765', 'tt0172495', 'tt0103064', 'tt0032553', 'tt0054215', 'tt0034583', 'tt0021749', 'tt0064116', 'tt0027977', 'tt8291224', 'tt8108198', 'tt5311514', 'tt8267604', 'tt5074352', 'tt1853728', 'tt0910970', 'tt0209144', 'tt0986264', 'tt4633694', 'tt2380307', 'tt0119698', 'tt1187043', 'tt0405094', 'tt0364569', 'tt0081505', 'tt0082971', 'tt1345836', 'tt0087843', 'tt0078748', 'tt0078788', 'tt0051201', 'tt0057012', 'tt0050825', 'tt0047396', 'tt4729430', 'tt0043014', 'tt1950186', 'tt2106476', 'tt0476735', 'tt1832382', 'tt1255953', 'tt0435761', 'tt0361748', 'tt0208092', 'tt0211915', 'tt0169547', 'tt0119217', 'tt0338013', 'tt0180093', 'tt0116231', 'tt0091251', 'tt0112573', 'tt0118849', 'tt0114709', 'tt0093058', 'tt0105236', 'tt0086879', 'tt0086250', 'tt0090605', 'tt0082096', 'tt0070735', 'tt0066921', 'tt0086190', 'tt0075314', 'tt0059578', 'tt0062622', 'tt0056172', 'tt0053604', 'tt0053125', 'tt0056592', 'tt0052357', 'tt0040522', 'tt0045152', 'tt0036775', 'tt0044741', 'tt0022100', 'tt0033467', 'tt7653254', 'tt0017136', 'tt0012349', 'tt5323662', 'tt5571734', 'tt7838252', 'tt6966692', 'tt4934950', 'tt3322420', 'tt4430212', 'tt4849438', 'tt2758880', 'tt5027774', 'tt2283748', 'tt2356180', 'tt2991224', 'tt2096673', 'tt1639426', 'tt1954470', 'tt1305806', 'tt1291584', 'tt0993846', 'tt1049413', 'tt1620933', 'tt0871510', 'tt0469494', 'tt0457430', 'tt0434409', 'tt0405508', 'tt0363163', 'tt0375611', 'tt0242519', 'tt0347149', 'tt0268978', 'tt0367110', 'tt0372784', 'tt0120735', 'tt0169858', 'tt0119488', 'tt0109117', 'tt0113277', 'tt0112641', 'tt0097576', 'tt0105695', 'tt0096283', 'tt0095016', 'tt0089881', 'tt0079944', 'tt0071853', 'tt0074896', 'tt0081398', 'tt0073707', 'tt0057115', 'tt0071315', 'tt0060107', 'tt0055630', 'tt0055031', 'tt0053291', 'tt0046912', 'tt0050976', 'tt0046438', 'tt0042876', 'tt0050986', 'tt0043338', 'tt0042041', 'tt0042192', 'tt0040897', 'tt0040725', 'tt0015864', 'tt3612616', 'tt8946378', 'tt3390572', 'tt0015324', 'tt4016934', 'tt3170832', 'tt3315342', 'tt2631186', 'tt4857264', 'tt2082197', 'tt3011894', 'tt2267998', 'tt2140203', 'tt2119532', 'tt2024544', 'tt2338151', 'tt2278388', 'tt1865505', 'tt1454029', 'tt1821480', 'tt1979320', 'tt1302006', 'tt1392214', 'tt1280558', 'tt1205489', 'tt1895587', 'tt1392190', 'tt1562872', 'tt0978762', 'tt1130884', 'tt1028532', 'tt0861739', 'tt1201607', 'tt0758758', 'tt1069238', 'tt0892769', 'tt0477348', 'tt0353969', 'tt0386064', 'tt0405159', 'tt0292490', 'tt0456144', 'tt0395169', 'tt0245712', 'tt0264464', 'tt0374887', 'tt0266697', 'tt0266543', 'tt0169102', 'tt0118843', 'tt0120731', 'tt0120382', 'tt0167404', 'tt0118715', 'tt0117951', 'tt0116282', 'tt0112870', 'tt0113247', 'tt0114787', 'tt0109424', 'tt0118694', 'tt0101640', 'tt0112471', 'tt0107207', 'tt0111495', 'tt0107290', 'tt0097165', 'tt0094625', 'tt0091763', 'tt0093779', 'tt0092005', 'tt0087544', 'tt0087884', 'tt0084787', 'tt0083946', 'tt0084503', 'tt0079470', 'tt0083658', 'tt0072684', 'tt0080678', 'tt0077416', 'tt0075148', 'tt0069467', 'tt0083922', 'tt0074958', 'tt0072443', 'tt0069293', 'tt0062229', 'tt0058946', 'tt0056732', 'tt0060827', 'tt0061512', 'tt0056687', 'tt0056443', 'tt0056217', 'tt0053946', 'tt0052618', 'tt0053198', 'tt0056111', 'tt0051808', 'tt0050783', 'tt0051036', 'tt0050212', 'tt0050613', 'tt0047296', 'tt0041959', 'tt0032976', 'tt0046268', 'tt0033045', 'tt0031679', 'tt0025316', 'tt0028950', 'tt0018455', 'tt0031381', 'tt0019254', 'tt0017925', 'tt7984734', 'tt8075192', 'tt4387040', 'tt0010323', 'tt3863552', 'tt3848892', 'tt3783958', 'tt3741834', 'tt3659388', 'tt2948356', 'tt3544112', 'tt2576852', 'tt2084970', 'tt2370248', 'tt2377938', 'tt2265171', 'tt2543472', 'tt1798709', 'tt1877832', 'tt1659337', 'tt1555149', 'tt1727824', 'tt2015381', 'tt1663202', 'tt1856101', 'tt1360860', 'tt1504320', 'tt1327035', 'tt1220719', 'tt1431045', 'tt1171701', 'tt1188996', 'tt0808417', 'tt0947798', 'tt1010048', 'tt0848228', 'tt0790636', 'tt0454921', 'tt0450259', 'tt0401792', 'tt0401383', 'tt0423866', 'tt0440963', 'tt0384116', 'tt0382932', 'tt0381061', 'tt0381681', 'tt0369702', 'tt0376968', 'tt0378194', 'tt0338564', 'tt0352248', 'tt0374546', 'tt0293715', 'tt0347304', 'tt0325980', 'tt0319061', 'tt0317705', 'tt0270053', 'tt0276919', 'tt0175880', 'tt0198781', 'tt0166896', 'tt0246578', 'tt0168629', 'tt0156887', 'tt0154420', 'tt0140888', 'tt0119472', 'tt0117666', 'tt0129167', 'tt0114746', 'tt0117589', 'tt0113824', 'tt0113568', 'tt0106469', 'tt0107688', 'tt0107048', 'tt0105323', 'tt0102138', 'tt0103639', 'tt0092593', 'tt0099348', 'tt0095953', 'tt0101414', 'tt0092067', 'tt0093191', 'tt0085334', 'tt0083987', 'tt0075686', 'tt0078841', 'tt0088247', 'tt0080979', 'tt0074119', 'tt0073195', 'tt0072890', 'tt0072431', 'tt0070510', 'tt0070047', 'tt0070511', 'tt0068182', 'tt0069281', 'tt0067328', 'tt0067093', 'tt0064115', 'tt0063442', 'tt0063522', 'tt0059742', 'tt0061811', 'tt0061184', 'tt0061722', 'tt0058461', 'tt0059113', 'tt0054997', 'tt0056801', 'tt0053779', 'tt0052561', 'tt0051459', 'tt0053221', 'tt0049406', 'tt0052311', 'tt0048424', 'tt0047528', 'tt0046911', 'tt0046250', 'tt0041546', 'tt0046359', 'tt0044079', 'tt0044081', 'tt0040746', 'tt0039689', 'tt0037558', 'tt0037008', 'tt0036613', 'tt0036868', 'tt0033870', 'tt0020629', 'tt0032551', 'tt0015648', 'tt0032138', 'tt5726616', 'tt5104604', 'tt4698684', 'tt5168192', 'tt3553976', 'tt5013056', 'tt2488496', 'tt2543164', 'tt2872718', 'tt2209418', 'tt3501632', 'tt1827487', 'tt1979376', 'tt1602620', 'tt1655442', 'tt1631867', 'tt1398426', 'tt1190539', 'tt1235166', 'tt1182345', 'tt1139797', 'tt1093370', 'tt1125849', 'tt1136608', 'tt1032846', 'tt1065073', 'tt0780536', 'tt0756683', 'tt0460791', 'tt0796366', 'tt0401085', 'tt0498380', 'tt0454876', 'tt0372824', 'tt0371746', 'tt0365748', 'tt0347048', 'tt0327056', 'tt0287467', 'tt0299977', 'tt0258463', 'tt0247586', 'tt0283509', 'tt0275277', 'tt0304141', 'tt0166924', 'tt0181875', 'tt0206634', 'tt0115751', 'tt0120363', 'tt0110729', 'tt0108394', 'tt0118749', 'tt0108399', 'tt0106519', 'tt0107692', 'tt0099487', 'tt0097814', 'tt0097937', 'tt0094226', 'tt0097216', 'tt0088258', 'tt0097123', 'tt0088847', 'tt0088846', 'tt0091167', 'tt0078754', 'tt0079522', 'tt0077405', 'tt0080455', 'tt0075029', 'tt0071615', 'tt0077402', 'tt0071129', 'tt0067185', 'tt0066206', 'tt0068361', 'tt0065214', 'tt0063350', 'tt0063227', 'tt0056218', 'tt0049730', 'tt0053472', 'tt0052893', 'tt0042546', 'tt0048028', 'tt0054331', 'tt0044706', 'tt0039628', 'tt0038787', 'tt0037884', 'tt0038355', 'tt0036342', 'tt0032904', 'tt0037382', 'tt0031971', 'tt0032599', 'tt0029947', 'tt0029843', 'tt0026778', 'tt0056923', 'tt0013442', 'tt0024216', 'tt4901306', 'tt5186714', 'tt4912910', 'tt4846340', 'tt4468740', 'tt0022913', 'tt7131622', 'tt3841424', 'tt4302938', 'tt4034228', 'tt3748528', 'tt3262342', 'tt3460252', 'tt3498820', 'tt3169706', 'tt2350496', 'tt2404461', 'tt2317337', 'tt2358891', 'tt2013293', 'tt2024519', 'tt1924396', 'tt2181931', 'tt1588170', 'tt2245084', 'tt1646971', 'tt1527788', 'tt1590089', 'tt1568346', 'tt0914798', 'tt1490017', 'tt2194499', 'tt1748122', 'tt1216496', 'tt1596363', 'tt1535109', 'tt1170358', 'tt1132620', 'tt1149362', 'tt0936501', 'tt0808506', 'tt0907657', 'tt0903624', 'tt0780504', 'tt0964517', 'tt0765429', 'tt0880502', 'tt0783233', 'tt0499549', 'tt0472043', 'tt0449059', 'tt0432283', 'tt0425112', 'tt0421715', 'tt0420332', 'tt0418455', 'tt0414387', 'tt0485947', 'tt0388473', 'tt0412080', 'tt0375679', 'tt0358273', 'tt0379786', 'tt0332280', 'tt0318462', 'tt0300140', 'tt0338309', 'tt0245844', 'tt0243017', 'tt0240772', 'tt0210945', 'tt0185125', 'tt0190332', 'tt0144117', 'tt0140352', 'tt0126029', 'tt0125659', 'tt0132477', 'tt0162222', 'tt0286244', 'tt0120338', 'tt0119250', 'tt0119177', 'tt0119174', 'tt0109707', 'tt0108550', 'tt0108358', 'tt0108037', 'tt0107943', 'tt0106977', 'tt0107653', 'tt0106489', 'tt0104652', 'tt0106364', 'tt0104684', 'tt0102536', 'tt0101765', 'tt0100157', 'tt0100150', 'tt0099077', 'tt0097202', 'tt0097441', 'tt0096874', 'tt0096163', 'tt0095647', 'tt0093773', 'tt0092991', 'tt0091042', 'tt0090967', 'tt0089218', 'tt0090756', 'tt0092965', 'tt0087553', 'tt0088939', 'tt0087332', 'tt0086197', 'tt0085794', 'tt0083866', 'tt0079417', 'tt0077651', 'tt0073341', 'tt0071360', 'tt0069762', 'tt0069947', 'tt0067992', 'tt0064665', 'tt0062467', 'tt0061735', 'tt0061578', 'tt0068327', 'tt0061418', 'tt0058385', 'tt0058331', 'tt0056197', 'tt0055032', 'tt0049833', 'tt0045061', 'tt0040724', 'tt0040506', 'tt0030341', 'tt0026138', 'tt0032455', 'tt7668870', 'tt6155172', 'tt0023969', 'tt5052448', 'tt5463162', 'tt5362988', 'tt4080728', 'tt4364194', 'tt3829920', 'tt0021884', 'tt3606756', 'tt3416742', 'tt3398268', 'tt2980516', 'tt2802144', 'tt2582496', 'tt2562232', 'tt2582846', 'tt2278871', 'tt1843866', 'tt1772341', 'tt1754656', 'tt1683526', 'tt1605783', 'tt1517451', 'tt1454468', 'tt1821549', 'tt1408101', 'tt1365050', 'tt1285016', 'tt1270798', 'tt1074638', 'tt1045658', 'tt1022603', 'tt1024648', 'tt0876563', 'tt1119646', 'tt0870111', 'tt0851578', 'tt0926084', 'tt0758742', 'tt0817177', 'tt0470752', 'tt0480025', 'tt0457655', 'tt0455590', 'tt0443706', 'tt0425210', 'tt0824747', 'tt0424205', 'tt0421082', 'tt0389557', 'tt0398286', 'tt0388795', 'tt0381849', 'tt0372183', 'tt0350258', 'tt0373074', 'tt0335266', 'tt0328107', 'tt0327597', 'tt0330373', 'tt0325710', 'tt0318411', 'tt0361862', 'tt0315733', 'tt0308644', 'tt0301357', 'tt0298845', 'tt0268126', 'tt0265086', 'tt0257044', 'tt0250258', 'tt0249462', 'tt0248845', 'tt0216651', 'tt0190590', 'tt0158983', 'tt0151804', 'tt0147612', 'tt0165832', 'tt0139654', 'tt0130827', 'tt0128445', 'tt0120601', 'tt0119038', 'tt0119008', 'tt0119822', 'tt0117631', 'tt0117381', 'tt0116477', 'tt0113670', 'tt0111507', 'tt0119116', 'tt0110877', 'tt0109445', 'tt0108122', 'tt0107818', 'tt0104940', 'tt0104691', 'tt0104348', 'tt0104257', 'tt0104797', 'tt0101507', 'tt0101921', 'tt0096438', 'tt0101410', 'tt0093389', 'tt0094336', 'tt0091605', 'tt0089853', 'tt0088680', 'tt0084855', 'tt0084726', 'tt0081283', 'tt0083944', 'tt0086637', 'tt0080339', 'tt0074811', 'tt0073312', 'tt0070666', 'tt0070034', 'tt0071230', 'tt0068473', 'tt0067140', 'tt0067116', 'tt0066999', 'tt0063374', 'tt0065207', 'tt0061395', 'tt0060665', 'tt0059646', 'tt0058777', 'tt0058150', 'tt0056869', 'tt0054167', 'tt0054698', 'tt0054047', 'tt0049366', 'tt0048545', 'tt0043456', 'tt0043265', 'tt0047437', 'tt0038559', 'tt0026029', 'tt6543652', 'tt0024184', 'tt6320628', 'tt5649144', 'tt6304162', 'tt5462602', 'tt5461944', 'tt5083738', 'tt4226388', 'tt4481414', 'tt3966404', 'tt3890160', 'tt3896198', 'tt3682448', 'tt3521164', 'tt3076658', 'tt3397884', 'tt2802154', 'tt2713180', 'tt2582782', 'tt2431286', 'tt1937149', 'tt2103281', 'tt1899353', 'tt1855199', 'tt1649419', 'tt1568921', 'tt1542344', 'tt1410063', 'tt1436045', 'tt1403865', 'tt1340107', 'tt1323594', 'tt1306980', 'tt1318514', 'tt1242422', 'tt1250777', 'tt1210166', 'tt1189073', 'tt1156398', 'tt1078188', 'tt1063669', 'tt0988045', 'tt0986233', 'tt0983213', 'tt0976051', 'tt0887912', 'tt0878804', 'tt0829482', 'tt0857191', 'tt0765443', 'tt0814314', 'tt0486655', 'tt0485601', 'tt0456912', 'tt0454848', 'tt0452623', 'tt0451094', 'tt0450188', 'tt0446059', 'tt0443543', 'tt0441909', 'tt0427944', 'tt0420223', 'tt0419887', 'tt0419677', 'tt0417741', 'tt0416449', 'tt0416320', 'tt0409459', 'tt0399295', 'tt0387564', 'tt0370986', 'tt0364517', 'tt0344510', 'tt0383028', 'tt0340377', 'tt0314331', 'tt0310775', 'tt0307901', 'tt0289992', 'tt0289879', 'tt0289043', 'tt0277027', 'tt0266308', 'tt0265666', 'tt0245574', 'tt0230600', 'tt0241527', 'tt0221027', 'tt0215750', 'tt0181689', 'tt0174856', 'tt0181865', 'tt0144084', 'tt0120863', 'tt0120802', 'tt0120762', 'tt0120669', 'tt0119167', 'tt0118929', 'tt0117665', 'tt0116922', 'tt0114388', 'tt0112817', 'tt0112864', 'tt0112579', 'tt0110148', 'tt0112384', 'tt0109506', 'tt0107822', 'tt0106856', 'tt0106677', 'tt0104952', 'tt0103939', 'tt0101700', 'tt0099810', 'tt0099785', 'tt0099674', 'tt0098635', 'tt0097958', 'tt0097757', 'tt0096754', 'tt0094947', 'tt0093748', 'tt0093409', 'tt0087469', 'tt0086979', 'tt0085959', 'tt0095705', 'tt0084707', 'tt0084649', 'tt0082846', 'tt0082694', 'tt0080120', 'tt0079588', 'tt0079116', 'tt0078480', 'tt0077928', 'tt0075860', 'tt0073582', 'tt0070608', 'tt0066765', 'tt0065938', 'tt0063462', 'tt0061852', 'tt0060176', 'tt0059592', 'tt0058182', 'tt0057345', 'tt0056193', 'tt0045793', 'tt0046303', 'tt0049261', 'tt0029583', 'tt0840361', 'tt0408306', 'tt0441773', 'tt0217505', 'tt0093870', 'tt0091064']}, {"sentence": 1, "_id": 0}, skip=total_processed, limit=LIMIT)
        if ss is None:
            print("END OF SENTENCES REACHED!")
            break

        for s in ss:
            output.write(f"{s['sentence']}\n")
            total_processed += 1

        output.flush()
        print("{} sentences have been downloaded so far".format(total_processed))
        if total_processed % LIMIT != 0:
            print("END OF SENTENCES REACHED!")
            break
except:
    pass

output.flush()
output.close()
print(f"Finished. If you want to resume the script, set START_COUNT to {total_processed}")
